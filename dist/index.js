!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.cccache=t():e.cccache=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){e.exports=function(){"use strict";var e="millisecond",t="second",n="minute",r="hour",i="day",o="week",u="month",a="quarter",s="year",c=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,f=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,l=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},d={s:l,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+l(r,2,"0")+":"+l(i,2,"0")},m:function(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,u),i=t-r<0,o=e.clone().add(n+(i?-1:1),u);return Number(-(n+(t-r)/(i?r-o:o-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(c){return{M:u,y:s,w:o,d:i,D:"date",h:r,m:n,s:t,ms:e,Q:a}[c]||String(c||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m="en",v={};v[m]=h;var y=function(e){return e instanceof b},p=function(e,t,n){var r;if(!e)return m;if("string"==typeof e)v[e]&&(r=e),t&&(v[e]=t,r=e);else{var i=e.name;v[i]=e,r=i}return!n&&r&&(m=r),r||!n&&m},g=function(e,t){if(y(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new b(n)},$=d;$.l=p,$.i=y,$.w=function(e,t){return g(e,{locale:t.$L,utc:t.$u,$offset:t.$offset})};var b=function(){function l(e){this.$L=this.$L||p(e.locale,null,!0),this.parse(e)}var d=l.prototype;return d.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if($.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(c);if(r)return n?new Date(Date.UTC(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)):new Date(r[1],r[2]-1,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)}return new Date(t)}(e),this.init()},d.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},d.$utils=function(){return $},d.isValid=function(){return!("Invalid Date"===this.$d.toString())},d.isSame=function(e,t){var n=g(e);return this.startOf(t)<=n&&n<=this.endOf(t)},d.isAfter=function(e,t){return g(e)<this.startOf(t)},d.isBefore=function(e,t){return this.endOf(t)<g(e)},d.$g=function(e,t,n){return $.u(e)?this[t]:this.set(n,e)},d.year=function(e){return this.$g(e,"$y",s)},d.month=function(e){return this.$g(e,"$M",u)},d.day=function(e){return this.$g(e,"$W",i)},d.date=function(e){return this.$g(e,"$D","date")},d.hour=function(e){return this.$g(e,"$H",r)},d.minute=function(e){return this.$g(e,"$m",n)},d.second=function(e){return this.$g(e,"$s",t)},d.millisecond=function(t){return this.$g(t,"$ms",e)},d.unix=function(){return Math.floor(this.valueOf()/1e3)},d.valueOf=function(){return this.$d.getTime()},d.startOf=function(e,a){var c=this,f=!!$.u(a)||a,l=$.p(e),d=function(e,t){var n=$.w(c.$u?Date.UTC(c.$y,t,e):new Date(c.$y,t,e),c);return f?n:n.endOf(i)},h=function(e,t){return $.w(c.toDate()[e].apply(c.toDate("s"),(f?[0,0,0,0]:[23,59,59,999]).slice(t)),c)},m=this.$W,v=this.$M,y=this.$D,p="set"+(this.$u?"UTC":"");switch(l){case s:return f?d(1,0):d(31,11);case u:return f?d(1,v):d(0,v+1);case o:var g=this.$locale().weekStart||0,b=(m<g?m+7:m)-g;return d(f?y-b:y+(6-b),v);case i:case"date":return h(p+"Hours",0);case r:return h(p+"Minutes",1);case n:return h(p+"Seconds",2);case t:return h(p+"Milliseconds",3);default:return this.clone()}},d.endOf=function(e){return this.startOf(e,!1)},d.$set=function(o,a){var c,f=$.p(o),l="set"+(this.$u?"UTC":""),d=(c={},c[i]=l+"Date",c.date=l+"Date",c[u]=l+"Month",c[s]=l+"FullYear",c[r]=l+"Hours",c[n]=l+"Minutes",c[t]=l+"Seconds",c[e]=l+"Milliseconds",c)[f],h=f===i?this.$D+(a-this.$W):a;if(f===u||f===s){var m=this.clone().set("date",1);m.$d[d](h),m.init(),this.$d=m.set("date",Math.min(this.$D,m.daysInMonth())).toDate()}else d&&this.$d[d](h);return this.init(),this},d.set=function(e,t){return this.clone().$set(e,t)},d.get=function(e){return this[$.p(e)]()},d.add=function(e,a){var c,f=this;e=Number(e);var l=$.p(a),d=function(t){var n=g(f);return $.w(n.date(n.date()+Math.round(t*e)),f)};if(l===u)return this.set(u,this.$M+e);if(l===s)return this.set(s,this.$y+e);if(l===i)return d(1);if(l===o)return d(7);var h=(c={},c[n]=6e4,c[r]=36e5,c[t]=1e3,c)[l]||1,m=this.$d.getTime()+e*h;return $.w(m,this)},d.subtract=function(e,t){return this.add(-1*e,t)},d.format=function(e){var t=this;if(!this.isValid())return"Invalid Date";var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=$.z(this),i=this.$locale(),o=this.$H,u=this.$m,a=this.$M,s=i.weekdays,c=i.months,l=function(e,r,i,o){return e&&(e[r]||e(t,n))||i[r].substr(0,o)},d=function(e){return $.s(o%12||12,e,"0")},h=i.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:$.s(a+1,2,"0"),MMM:l(i.monthsShort,a,c,3),MMMM:c[a]||c(this,n),D:this.$D,DD:$.s(this.$D,2,"0"),d:String(this.$W),dd:l(i.weekdaysMin,this.$W,s,2),ddd:l(i.weekdaysShort,this.$W,s,3),dddd:s[this.$W],H:String(o),HH:$.s(o,2,"0"),h:d(1),hh:d(2),a:h(o,u,!0),A:h(o,u,!1),m:String(u),mm:$.s(u,2,"0"),s:String(this.$s),ss:$.s(this.$s,2,"0"),SSS:$.s(this.$ms,3,"0"),Z:r};return n.replace(f,(function(e,t){return t||m[e]||r.replace(":","")}))},d.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},d.diff=function(e,c,f){var l,d=$.p(c),h=g(e),m=6e4*(h.utcOffset()-this.utcOffset()),v=this-h,y=$.m(this,h);return y=(l={},l[s]=y/12,l[u]=y,l[a]=y/3,l[o]=(v-m)/6048e5,l[i]=(v-m)/864e5,l[r]=v/36e5,l[n]=v/6e4,l[t]=v/1e3,l)[d]||v,f?y:$.a(y)},d.daysInMonth=function(){return this.endOf(u).$D},d.$locale=function(){return v[this.$L]},d.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=p(e,t,!0);return r&&(n.$L=r),n},d.clone=function(){return $.w(this.$d,this)},d.toDate=function(){return new Date(this.valueOf())},d.toJSON=function(){return this.isValid()?this.toISOString():null},d.toISOString=function(){return this.$d.toISOString()},d.toString=function(){return this.$d.toUTCString()},l}();return g.prototype=b.prototype,g.extend=function(e,t){return e(t,b,g),g},g.locale=p,g.isDayjs=y,g.unix=function(e){return g(1e3*e)},g.en=v[m],g.Ls=v,g}()},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.status="not"}var t,n,i;return t=e,(n=[{key:"open",value:function(){var e=this;return new Promise((function(t,n){var r=window.indexedDB.open("cccache");r.onsuccess=function(n){e.db=r.result,e.status="open",t()},r.onerror=function(e){n()},r.onblocked=function(e){n()},r.onupgradeneeded=function(t){e.db=t.target.result,e.status="open",e.db.objectStoreNames.contains("d")||e.db.createObjectStore("d",{keyPath:"key"})}}))}},{key:"trans",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"readwrite";return new Promise((function(r,i){if("open"===t.status){var o=t.db.transaction(["d"],n).objectStore("d"),u=e(o);u.onerror=function(){i()},u.onsuccess=function(e){r(e.result)}}}))}},{key:"set",value:function(e,t){return this.trans((function(n){return n.put({key:e,value:t})}))}},{key:"get",value:function(e){return this.trans((function(t){return t.get(e)}),"readonly")}},{key:"del",value:function(e){return this.trans((function(t){return t.delete(e)}))}},{key:"all",value:function(){var e=this;return new Promise((function(t,n){if("open"===e.status){var r=e.db.transaction(["d"],"readonly").objectStore("d"),i=[];r.openCursor().onsuccess=function(e){var n=e.target.result;n?(i.push(n.value),n.continue()):t(i)}}}))}}])&&r(t.prototype,n),i&&r(t,i),e}()),o=n(0),u=n.n(o);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s=function(e){return!!e&&Date.now()>=e};function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(null===e||"object"!==a(e))return e;var n=t.filter((function(t){return t.original===e}))[0];if(n)return n.copy;var r=Array.isArray(e)?[]:{};return t.push({original:e,copy:r}),Object.keys(e).forEach((function(n){r[n]=c(e[n],t)})),r}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Symbol("expired");var l=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"set",value:function(e,t){e="cccache-"+e;var n=JSON.stringify(t);localStorage.setItem(e,n)}},{key:"get",value:function(e){e="cccache-"+e;var t=localStorage.getItem(e);return t?JSON.parse(t):null}},{key:"flash",value:function(e){e="cccache-"+e;var t=this.get(e);return this.del(e),t}},{key:"del",value:function(e){e="cccache-"+e,localStorage.removeItem(e)}}])&&f(t.prototype,n),r&&f(t,r),e}());function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"default",(function(){return h}));var h=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.memCache=new Map,this.initTime=Date.now(),i.open().then((function(e){t.loadIndexedDB()}))}var t,n,r;return t=e,(n=[{key:"loadIndexedDB",value:function(){var e=this,t=[];i.all().then((function(n){n.forEach((function(n){s(n.expire)?t.push(n.key):(console.log(n,c(n)),e.memCache.set(n.key,c(n.value)))})),t.forEach((function(e){i.del(e)}))}))}},{key:"loadLocalStorage",value:function(){for(var e=[],t=(Date.now(),0);t<localStorage.length;t++){var n=localStorage.key(t);if(0===n.indexOf("cccache-")){var r=l.get(n.replace("cccache-",""));s(r.expire)?e.push(n):this.memCache.set(r.key,r)}}e.forEach((function(e){localStorage.removeItem(e)}))}},{key:"setConfig",value:function(e){this.config=e}},{key:"set",value:function(e,t,n){var r={value:c(t)};n=Object.assign({},n,this.config),r.expire=function(e){if(!e.expire)return 0;if("in"!==e.expire[0]){if("at"===e.expire[0]){var t=e.expire[1],n=u()(),r=["month","date","hour","minute","second","millisecond"],i=function(e,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",u=n.format(e),a=t,s=r.indexOf(i);if(o){var c=r[s+1];a=Number(t.replace(o,"")),console.log(c,a,u,t),"week"===i&&(s=r.indexOf("month"),c="day"),Number(u)>a&&(n=n.add(1,i)),n=n.set(c,a)}else u>t&&(n=n.add(1,i));for(var f=s+2;f<r.length;f++)n="date"===r[f]?n.set(r[f],1):n.set(r[f],0)};if(/\d{2}:\d{2}:\d{2}/.test(t)){i("HH:mm:ss","day");var o=t.split(":").map((function(e){return Number(e)}));n=n.hour(o[0]).minute(o[1]).second(o[2])}else if(/\d{2}:\d{2}/.test(t)){i("HH:mm","day");var a=t.split(":").map((function(e){return Number(e)}));n=n.hour(a[0]).minute(a[1])}else if(/\d{1,2}-\d{1,2}/.test(t)){i("M-D","year");var s=t.split("-").map((function(e){return Number(e)}));n=n.month(s[0]-1).date(s[1])}else/M\d{1,2}/.test(t)?i("M","year","M"):/D\d/.test(t)?i("D","month","D"):/d\d/.test(t)?i("d","week","d"):/h\d+/.test(t)?i("H","date","h"):/m\d+/.test(t)?i("m","hour","m"):/s\d+/.test(t)?i("s","minute","s"):console.log("expired time format illegal",e.expire);return n.valueOf()}return 0}var c=e.expire[1];if(/[0-9]+(Y|M|D|h|m|s|t)/.test(c)){var f=c.substr(c.length-1),l=Number(c.substr(0,c.length-1)),d=new Date;switch(console.log(d.getTime()),f){case"Y":d.setFullYear(d.getFullYear()+l);break;case"M":d.setMonth(d.getMonth()+l);break;case"D":d.setDate(d.getDate()+l);break;case"h":d.setHours(d.getHours()+l);break;case"m":d.setMinutes(d.getMinutes()+l);break;case"s":d.setSeconds(d.getSeconds()+l);break;case"t":d.setMilliseconds(d.getMilliseconds()+l);break;default:d=null}return console.log(d.getTime()),d?d.getTime():0}console.log("expired time format illegal",e.expire)}(n),console.log(r.expire,Date.now()),r.level=n.level||"mem",r.zip=n.zip||!1,r.createdAt=Date.now(),r.zip&&(r.value=r.value),this.memCache.set(e,r),"local"===r.level&&l.set(e,r),i.set(e,r)}},{key:"get",value:function(e,t){var n=this.memCache.get(e);if((!n||t&&n.level!==t)&&(n=l.get(e)),n){if(!s(n.expire))return n.zip,n.value;console.log("expired"),this.del(e)}}},{key:"del",value:function(e,t){this.memCache.delete(e),t&&"local"!==t||l.del(e),i.del(e)}}])&&d(t.prototype,n),r&&d(t,r),e}()}])}));